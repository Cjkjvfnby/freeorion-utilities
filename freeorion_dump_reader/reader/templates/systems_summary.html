{% extends "summary.html" %}
{% load staticfiles %}
{% block title %}Game {{ game }}{% endblock %}

{% block extrahead %}
<script src="{% static "js/jquery-2.1.3.js" %}"></script>
<script src="{% static "js/leaflet.js" %}"></script>
<link rel="stylesheet" href="{% static "css/leaflet.css" %}" />
{% endblock %}

{% block content %}
<script>
$(function () {
    var customCRS = L.extend(L.CRS.Simple, {
		projection: L.extend( L.Projection.LonLat, {
			bounds: L.bounds([0, 0], [2160, 4096])
		}),
		transformation: new L.Transformation(1, 0, 1, 0),
		scale: function (zoom) {
			return Math.pow(2, zoom -2);
		},
		infinite: false
	});

 var map = L.map('map',{crs: customCRS});

 L.tileLayer('', {
    attribution: 'FreeOrion',
    maxZoom: 18,
}).addTo(map);

{% for starlane in data.starlanes%}
var polyline = L.polyline({{starlane}}, {color: 'red', 'opacity': 0.5, 'lineCap':'butt', 'weight':1, 'dashArray': '3,2'}).addTo(map);
{% endfor %}

{% for system in data.points %}
   var circle = L.circle({{system.coords}}, 100, {
       color: 'red',
       fillColor: '#f03',
       fillOpacity: 0.5
   }).addTo(map);
    var popup = L.popup().setContent(
    '{% for k, v in system.items %}<p>{{k}}: {{v}}</p>{% endfor %}');
    circle.bindPopup(popup);
{% endfor %}

map.setView({{data.points.0.coords}}, 2)
});
</script>

 <div id="map" style="height: 600px"></div>
{% endblock %}
